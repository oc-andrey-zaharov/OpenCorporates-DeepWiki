#!/usr/bin/env bash

# DeepWiki CLI Wrapper Script
# Automatically activates the Poetry environment and runs the deepwiki command

# Get the directory where this script is located (project root)
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Check if pyproject.toml exists in root
if [ ! -f "$SCRIPT_DIR/pyproject.toml" ]; then
    echo "Error: pyproject.toml not found at $SCRIPT_DIR" >&2
    exit 1
fi

# Stay in the project root where pyproject.toml is located
cd "$SCRIPT_DIR" || exit 1

# Ensure dependencies are installed (poetry install is idempotent)
poetry install --no-interaction --quiet > /dev/null 2>&1 || {
    echo "Warning: Failed to install dependencies. Continuing anyway..." >&2
}

# Run deepwiki through poetry
poetry run deepwiki "$@"

